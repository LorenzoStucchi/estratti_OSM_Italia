{"version":3,"sources":["components/Breadcrumb/Breadcrumb.module.css","components/SideMenu/DownloadItems/DownloadItems.module.css","components/SideMenu/SideMenu.module.css","components/Italy.js","components/Breadcrumb/Breadcrumb.js","components/SideMenu/filter.js","components/SideMenu/DownloadItems/DownloadItems.js","helpers.js","components/SideMenu/SideMenu.js","App.js","index.js"],"names":["module","exports","pathColors","getComputedStyle","document","documentElement","getPropertyValue","Italy","type","currentGeoJSON","italyTree","selectedTreeItem","setSelectedTreeItem","geoJSONref","useRef","map","useMap","useEffect","current","bounds","getBounds","Object","entries","length","fitBounds","GeoJSON","ref","eventHandlers","click","e","a","feature","layer","geo_reg_istat","reg_istat","region","children","find","item","properties","adm","istat","geo_prov_istat","prov_istat","geo_com_istat","province","com_istat","pathOptions","color","data","Breadcrumb","breadcrumbData","getParentData","allData","push","parent","reverse","className","styles","breadcrumb","appTitle","node","index","style","zIndex","breadItem","onClick","com_name","prov_name","reg_name","name","search","term","foundIDS","isMatching","toLowerCase","indexOf","Array","isArray","forEach","child","hasMatchingChild","id","ToolTipButton","title","href","tooltip","Tooltip","Button","variant","target","startIcon","button","DownloadItems","selectedFeature","resultItem","italyBounds","geoRegions","topojson","regions","geoProvinces","provinces","parentItem","getProvincesFromRegionIstatCode","istatCode","console","log","provincesIstatCodes","filteredProvinces","features","filter","includes","getMunicipalitiesForProvinceIstatCode","provinceIstatCode","fileName","config","basePathApp","inputFilesPath","fetch","fileFetched","json","municipalities","findMunicipalityInProvince","scrollToElement","element","scrollIntoView","behavior","block","inline","SideMenu","useState","expanded","setExpanded","selected","setSelected","searchFilter","setSearchFilter","searchValue","setSearchValue","preventExpand","toExpand","xpath","targetItem","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","searchNode","dataNode","matchedIDS","searchDebounced","useDebouncedCallback","value","sideMenu","TextField","label","onChange","callback","TreeView","defaultCollapseIcon","defaultExpandIcon","onNodeSelect","_","nodeIds","mapTree","TreeItem","nodeId","onLabelClick","event","slice","setTimeout","App","useMemo","getChildFeatures","prov_istat_code","reg_istat_code","com_istat_code","previousRegions","previousProvinces","commonMunicipalityProperties","municipality","featureGeometry","municipalityFeature","makeItalianTree","setCurrentGeoJSON","setSelectedFeature","then","MapContainer","zoom","minZoom","maxBounds","maxBoundsViscosity","scrollWheelZoom","TileLayer","attribution","url","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.9d084b10.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"breadcrumb\":\"Breadcrumb_breadcrumb__VvPxc\",\"breadItem\":\"Breadcrumb_breadItem__Fr3qm\",\"appTitle\":\"Breadcrumb_appTitle__3Xzjs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"resultItem\":\"DownloadItems_resultItem__3CTww\",\"button\":\"DownloadItems_button__10wNR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sideMenu\":\"SideMenu_sideMenu__2Qg5Y\"};","import { useEffect, useRef } from \"react\";\nimport { GeoJSON, useMap } from \"react-leaflet\";\n\nconst pathColors = [\n  getComputedStyle(document.documentElement).getPropertyValue(\"--mainColor1\"),\n  getComputedStyle(document.documentElement).getPropertyValue(\"--mainColor2\"),\n  getComputedStyle(document.documentElement).getPropertyValue(\"--mainColor3\"),\n  getComputedStyle(document.documentElement).getPropertyValue(\"--mainColor4\"),\n];\n\nconst getPathColor = (type) => {\n  return pathColors[type / 2 - 1];\n};\n\nconst Italy = ({\n  currentGeoJSON,\n  italyTree,\n  selectedTreeItem,\n  setSelectedTreeItem,\n}) => {\n  const geoJSONref = useRef();\n  const map = useMap();\n\n  useEffect(() => {\n    if (!geoJSONref.current) {\n      return;\n    }\n    const bounds = geoJSONref.current.getBounds();\n    if (!Object.entries(bounds).length) {\n      return;\n    }\n    map.fitBounds(bounds);\n  }, [currentGeoJSON, geoJSONref, map]);\n\n  return (\n    <GeoJSON\n      ref={geoJSONref}\n      eventHandlers={{\n        click: async (e) => {\n          const feature = e.layer.feature;\n          const geo_reg_istat = currentGeoJSON.reg_istat;\n          const region = italyTree.children.find(\n            ({ reg_istat }) => reg_istat === geo_reg_istat\n          );\n\n          let item = null;\n\n          if (feature.properties.adm === 4) {\n            item = italyTree.children.find(\n              ({ reg_istat }) => reg_istat === feature.properties.istat\n            );\n          }\n\n          if (feature.properties.adm === 6) {\n            const geo_prov_istat = feature.properties.istat;\n            item = region.children.find(\n              ({ prov_istat }) => prov_istat === geo_prov_istat\n            );\n          }\n\n          if (feature.properties.adm === 8) {\n            const geo_prov_istat = currentGeoJSON.prov_istat;\n            const geo_com_istat = feature.properties.istat;\n            const province = region.children.find(\n              ({ prov_istat }) => prov_istat === geo_prov_istat\n            );\n            item = province.children.find(\n              ({ com_istat }) => com_istat === geo_com_istat\n            );\n          }\n\n          if (item) {\n            setSelectedTreeItem(item);\n          }\n        },\n      }}\n      pathOptions={{ color: getPathColor(selectedTreeItem.type) }}\n      key={\n        currentGeoJSON\n          ? currentGeoJSON.com_istat ||\n            currentGeoJSON.prov_istat ||\n            currentGeoJSON.reg_istat\n          : \"state\"\n      }\n      data={currentGeoJSON}\n    />\n  );\n};\n\nexport default Italy;\n","import styles from \"./Breadcrumb.module.css\";\n\nconst Breadcrumb = ({ selectedTreeItem, setSelectedTreeItem }) => {\n  const getParentData = (item, allData) => {\n    allData.push(item);\n    if (item.parent) {\n      return getParentData(item.parent, allData);\n    }\n    return allData;\n  };\n  const breadcrumbData = getParentData(selectedTreeItem, []).reverse();\n\n  return (\n    <div className={styles.breadcrumb}>\n      <div className={styles.appTitle}>\n        <h1>Estratti OpenStreetMap Italia</h1>\n      </div>\n      {breadcrumbData.map((node, index) => {\n        return (\n          <p\n            key={node.type}\n            style={{ zIndex: 4 - index }}\n            className={styles.breadItem}\n            onClick={() => setSelectedTreeItem(node)}\n          >\n            {node.com_name || node.prov_name || node.reg_name || node.name}\n          </p>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default Breadcrumb;\n","export const search = (node, term, foundIDS) => {\n  const name = node.com_name || node.prov_name || node.reg_name;\n  let isMatching =\n    term.length > 2 &&\n    name &&\n    name.toLowerCase().indexOf(term.toLowerCase()) > -1;\n  if (Array.isArray(node.children)) {\n    node.children.forEach((child) => {\n      const hasMatchingChild = search(child, term, foundIDS);\n      isMatching = isMatching || hasMatchingChild;\n    });\n  }\n\n  // We will add any item if it matches our search term or if it has a children that matches our term\n  if (isMatching && name) {\n    const id = node.com_istat || node.prov_istat || node.reg_istat || name;\n    foundIDS.push(id);\n  }\n  return isMatching;\n};\n","import styles from \"./DownloadItems.module.css\";\nimport Button from \"@material-ui/core/Button\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport config from \"../../../configuration.json\";\n\nconst ToolTipButton = ({ title, href, tooltip }) => (\n  <Tooltip title={tooltip}>\n    <Button\n      variant=\"contained\"\n      href={href}\n      target=\"_blank\"\n      startIcon={<SaveIcon />}\n      className={styles.button}\n      color=\"primary\"\n    >\n      {title}\n    </Button>\n  </Tooltip>\n);\n\nconst DownloadItems = ({ selectedFeature }) => {\n  if (!selectedFeature?.properties) {\n    return null;\n  }\n\n  const { properties } = selectedFeature;\n\n  if (!properties[\".gpkg\"] && !properties[\".osm.pbf\"]) {\n    return null;\n  }\n\n  return (\n    <div className={styles.resultItem}>\n      <p>Estratti disponibili per {properties.name}</p>\n      {properties[\".gpkg\"] && (\n        <ToolTipButton\n          tooltip=\"OGC GeoPackage\"\n          href={properties[\".gpkg\"]}\n          title=\"GPKG\"\n        />\n      )}\n      {properties[\".osm.pbf\"] && (\n        <ToolTipButton\n          tooltip=\"Protocolbuffer binary format\"\n          href={properties[\".osm.pbf\"]}\n          title=\"PBF\"\n        />\n      )}\n       {properties[\".obf\"] && (\n        <ToolTipButton\n          tooltip=\"OsmAnd OBF Format\"\n          href={properties[\".obf\"]}\n          title=\"OBF\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default DownloadItems;\n","import * as topojson from \"topojson-client\";\nimport provinces from \"./static/boundaries/limits_IT_provinces.json\";\nimport regions from \"./static/boundaries/limits_IT_regions.json\";\nimport municipalities from \"./static/boundaries/municipalitiesMap.json\";\nimport config from \"./configuration.json\";\n\nexport const italyBounds = [\n  [36.6199872, 6.74995527],\n  [47.11539317, 18.48024702],\n];\nexport const geoRegions = topojson.feature(regions, \"limits_IT_regions\");\nconst geoProvinces = topojson.feature(provinces, \"limits_IT_provinces\");\n\nexport const parentItem = \"Italia\";\n\nexport const getParentForFeature = (feature, selectedFeature) => {\n  if (feature.properties.adm === 6) {\n    return {\n      ...feature,\n      properties: {\n        ...feature.properties,\n        reg_name: selectedFeature.region.name,\n        reg_istat: selectedFeature.region.reg_istat,\n      },\n    };\n  }\n  return feature;\n};\n\nconst getProvincesFromRegionIstatCode = (italyTree, istatCode) => {\n  const region = italyTree.children.find(\n    ({ reg_istat }) => reg_istat === istatCode\n  );\n  console.log('region',region)\n  const provincesIstatCodes = region.children.map(\n    ({ prov_istat }) => prov_istat\n  );\n  console.log('provincesIstatCodes',provincesIstatCodes)\n\n  const filteredProvinces = geoProvinces.features.filter(({ properties }) =>\n    provincesIstatCodes.includes(properties.istat)\n  );\n\n  console.log('filteredProvinces',filteredProvinces)\n  return {\n    features: filteredProvinces,\n    type: \"FeatureCollection\",\n    properties: {\n      reg_istat: region.reg_istat,\n    },\n  };\n};\n\nexport const getMunicipalitiesForProvinceIstatCode = async (\n  provinceIstatCode\n) => {\n  const fileName = `${config.basePathApp +\n    config.inputFilesPath}limits_P_${provinceIstatCode}_municipalities.json`;\n  const fileFetched = await fetch(fileName);\n  const municipalities = await fileFetched.json();\n  return topojson.feature(\n    municipalities,\n    `limits_P_${provinceIstatCode}_municipalities`\n  );\n};\n\nconst findMunicipalityInProvince = (currentGeoJSON, com_istat) =>\n  currentGeoJSON.features.find(\n    ({ properties }) => properties.istat === com_istat\n  );\n\nexport const makeItalianTree = () => {\n  let italyTree = {\n    name: parentItem,\n    type: 2,\n    getChildFeatures: async () => geoRegions,\n    children: [],\n  };\n\n  municipalities.forEach(\n    ({\n      name,\n      reg_name,\n      prov_name,\n      prov_istat_code,\n      reg_istat_code,\n      com_istat_code,\n    }) => {\n      let previousRegions = italyTree.children.find(\n        ({ reg_name: name }) => name === reg_name\n      );\n      let previousProvinces = previousRegions\n        ? previousRegions?.children.find(\n            ({ prov_name: name }) => name === prov_name\n          )\n        : null;\n      const region = {\n        reg_name: reg_name,\n        reg_istat: reg_istat_code,\n        type: 4,\n        parent: italyTree,\n        getChildFeatures: async () => {\n          const provinces = getProvincesFromRegionIstatCode(\n            italyTree,\n            reg_istat_code\n          );\n          return { ...provinces, parent: italyTree, reg_istat: reg_istat_code };\n        },\n      };\n      const province = {\n        prov_name: prov_name,\n        prov_istat: prov_istat_code,\n        reg_istat: reg_istat_code,\n        reg_name: reg_name,\n        type: 6,\n        parent: region,\n        getChildFeatures: async () => {\n          const municipalities = await getMunicipalitiesForProvinceIstatCode(\n            prov_istat_code\n          );\n          return {\n            ...municipalities,\n            parent: region,\n            prov_istat: prov_istat_code,\n            reg_istat: reg_istat_code,\n          };\n        },\n      };\n      const commonMunicipalityProperties = {\n        com_name: name,\n        com_istat: com_istat_code,\n        type: 8,\n        prov_istat: prov_istat_code,\n        reg_istat: reg_istat_code,\n        reg_name,\n        prov_name,\n      };\n      const municipality = {\n        ...commonMunicipalityProperties,\n        parent: province,\n        getChildFeatures: async () => {\n          const featureGeometry = await province.getChildFeatures();\n          const municipalityFeature = findMunicipalityInProvince(\n            featureGeometry,\n            com_istat_code\n          );\n          return {\n            ...municipalityFeature,\n            com_istat: com_istat_code,\n            prov_istat: prov_istat_code,\n            reg_istat: reg_istat_code,\n          };\n        },\n      };\n\n      if (previousProvinces) {\n        //insert municipalities\n        previousProvinces.children.push(municipality);\n      } else if (previousRegions) {\n        //insert provinces\n        previousRegions.children.push({\n          ...province,\n          children: [municipality],\n        });\n      } else {\n        //insert regions\n        italyTree.children.push({\n          reg_name: reg_name,\n          reg_istat: reg_istat_code,\n          type: 4,\n          ...region,\n          children: [{ ...province, children: [municipality] }],\n        });\n      }\n    }\n  );\n  console.log(\"console.log(italyTree)\", italyTree);\n  return italyTree;\n};\n","/* eslint-disable no-unused-expressions */\nimport { useEffect, useState } from \"react\";\nimport TreeView from \"@material-ui/lab/TreeView\";\nimport TreeItem from \"@material-ui/lab/TreeItem\";\nimport TextField from \"@material-ui/core/TextField\";\nimport ArrowDropDownIcon from \"@material-ui/icons/ExpandMore\";\nimport ArrowRightIcon from \"@material-ui/icons/ChevronRight\";\nimport { useDebouncedCallback } from \"use-debounce\";\nimport { search } from \"./filter\";\nimport DownloadItems from \"./DownloadItems\";\nimport styles from \"./SideMenu.module.css\";\nimport { parentItem } from \"../../helpers\";\n\nconst scrollToElement = (element) =>\n  element.scrollIntoView({\n    behavior: \"smooth\",\n    block: \"center\",\n    inline: \"start\",\n  });\nconst SideMenu = ({\n  italyTree,\n  selectedTreeItem,\n  setSelectedTreeItem,\n  selectedFeature,\n}) => {\n  const [expanded, setExpanded] = useState([parentItem]);\n  const [selected, setSelected] = useState([parentItem]);\n  const [searchFilter, setSearchFilter] = useState([]);\n  const [searchValue, setSearchValue] = useState(\"\");\n\n  const resetFilter = () => {\n    setSearchFilter([]);\n    setSearchValue(\"\");\n  };\n  const handleSelect = (_, nodeIds) => {\n    setSelected(nodeIds);\n  };\n\n  useEffect(() => {\n    if (!selectedFeature) {\n      return;\n    }\n    //this prevents triggers from the sidemenu itself\n    if (selectedTreeItem.preventExpand) {\n      return;\n    }\n\n    resetFilter();\n    const toExpand = [\n      ...(selectedTreeItem.com_istat ? [selectedTreeItem.com_istat] : []),\n      ...(selectedTreeItem.prov_istat ? [selectedTreeItem.prov_istat] : []),\n      ...(selectedTreeItem.reg_istat ? [selectedTreeItem.reg_istat] : []),\n      parentItem,\n    ];\n    setExpanded(toExpand);\n    setSelected(toExpand[0]);\n\n    const name = selectedFeature?.properties?.name;\n    var xpath = `(//div[text()='${name}'])[last()]`;\n    const targetItem = document.evaluate(\n      xpath,\n      document,\n      null,\n      XPathResult.FIRST_ORDERED_NODE_TYPE,\n      null\n    ).singleNodeValue;\n    if (targetItem) {\n      scrollToElement(targetItem);\n    }\n  }, [selectedFeature, selectedTreeItem]);\n\n  const searchNode = (term) => {\n    const dataNode = {\n      children: italyTree.children,\n    };\n    const matchedIDS = [parentItem];\n    search(dataNode, term, matchedIDS);\n    if (matchedIDS.length > 1) {\n      setSearchFilter(matchedIDS);\n    } else {\n      setSearchFilter([]);\n    }\n    setExpanded(matchedIDS);\n    setSelected(matchedIDS);\n  };\n\n  const mapTree = ({ children, ...node }) => {\n    const id =\n      node.com_istat || node.prov_istat || node.reg_istat || parentItem;\n    const name = node.com_name || node.prov_name || node.reg_name || parentItem;\n    if (searchFilter.length && !searchFilter.includes(id)) {\n      return null;\n    }\n\n    return (\n      <TreeItem\n        key={id}\n        nodeId={id}\n        label={name}\n        onLabelClick={async (event) => {\n          //close on tap on selected node\n          if (\n            (node.reg_istat === expanded[0] && !node.prov_istat) ||\n            (node.prov_istat === expanded[0] && !node.com_istat)\n          ) {\n            setExpanded([...expanded.slice(1, expanded.length)]);\n            scrollToElement(event.target);\n            return;\n          }\n\n          const toExpand = [\n            ...(node.com_istat ? [node.com_istat] : []),\n            ...(node.prov_istat ? [node.prov_istat] : []),\n            ...(node.reg_istat ? [node.reg_istat] : []),\n            parentItem,\n          ];\n          setExpanded(toExpand);\n          node.preventExpand = true;\n          setSelectedTreeItem(node);\n\n          setTimeout(() => {\n            scrollToElement(event.target);\n          }, 200);\n        }}\n      >\n        {children && children.map(mapTree)}\n      </TreeItem>\n    );\n  };\n\n  const searchDebounced = useDebouncedCallback((value) => {\n    searchNode(value);\n  }, 500);\n\n  return (\n    <div className={styles.sideMenu}>\n      <TextField\n        label=\"Cerca\"\n        type=\"search\"\n        value={searchValue}\n        onChange={(e) => {\n          setSearchValue(e.target.value);\n          searchDebounced.callback(e.target.value);\n        }}\n      />\n\n      <TreeView\n        defaultCollapseIcon={<ArrowDropDownIcon />}\n        defaultExpandIcon={<ArrowRightIcon />}\n        expanded={expanded}\n        selected={selected}\n        onNodeSelect={handleSelect}\n      >\n        {mapTree(italyTree)}\n      </TreeView>\n      <DownloadItems selectedFeature={selectedFeature} />\n    </div>\n  );\n};\n\nexport default SideMenu;\n","import \"./App.css\";\nimport { MapContainer, TileLayer } from \"react-leaflet\";\nimport { useState, useMemo, useEffect } from \"react\";\nimport Italy from \"./components/Italy\";\nimport Breadcrumb from \"./components/Breadcrumb\";\nimport SideMenu from \"./components/SideMenu\";\nimport { italyBounds, geoRegions, makeItalianTree } from \"./helpers\";\n\nfunction App() {\n  const italyTree = useMemo(() => makeItalianTree(), []);\n  const [currentGeoJSON, setCurrentGeoJSON] = useState(geoRegions);\n  const [selectedTreeItem, setSelectedTreeItem] = useState(italyTree);\n  const [selectedFeature, setSelectedFeature] = useState(null);\n\n  useEffect(() => {\n    selectedTreeItem.getChildFeatures().then((feature) => {\n      setCurrentGeoJSON(feature);\n      console.log(\"feature\", feature);\n      setSelectedFeature(feature);\n    });\n  }, [selectedTreeItem]);\n\n  return (\n    <div className=\"container\">\n      <Breadcrumb\n        selectedTreeItem={selectedTreeItem}\n        setSelectedTreeItem={setSelectedTreeItem}\n      />\n      <div className=\"content\">\n        <MapContainer\n          id=\"mapContainer\"\n          zoom={6}\n          minZoom={6}\n          bounds={italyBounds}\n          maxBounds={italyBounds}\n          maxBoundsViscosity={1}\n          scrollWheelZoom={true}\n        >\n          <TileLayer\n            attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          />\n          <Italy\n            currentGeoJSON={currentGeoJSON}\n            italyTree={italyTree}\n            selectedTreeItem={selectedTreeItem}\n            setSelectedTreeItem={setSelectedTreeItem}\n          />\n        </MapContainer>\n        <SideMenu\n          italyTree={italyTree}\n          selectedTreeItem={selectedTreeItem}\n          setSelectedTreeItem={setSelectedTreeItem}\n          selectedFeature={selectedFeature}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}